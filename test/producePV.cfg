process TrackerPV =
{

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  # geometry (switched to tracker only geometry)
  # include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  es_source = XMLIdealGeometryESSource 
  {
    FileInPath GeometryConfiguration="Geometry/TrackerSimData/data/trackerSimConfiguration.xml"
    string rootNodeName = ""
  }

  # tracker geometry
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # tracker numbering
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
 
 
  source = PoolSource 
  { 
    untracked vstring fileNames = {"file:reco-application-tracking-finaltrackfits-ctffinalfitwithmaterial.root"}
#   untracked vstring fileNames = {"file:TracksTommaso.root"}
#    untracked vstring fileNames = {"file:bb_Et100_eta14.root"}
    untracked int32 maxEvents = -1
  }

#  module asciiOutput = AsciiOutputModule {}
  
  module trackAnalyzer =  TrackAnalyzer {}

  module primaryVertexProducer =  PrimaryVertexProducer 
  {

	# label of tracks to be used
	#string TrackLabel = "RSWMaterial"
	string TrackLabel = "CTFWMaterial"

	PSet TkFilterParameters =
	{
		double minPt = 0. // better for softish events
		double maxD0Significance = 5. // keep most primary tracks
	}
	PSet TkClusParameters =
	{
		double zSeparation = 0.1 // 1 mm max separation betw. clusters
	}
	PSet PVSelParameters = 
	{
		double maxDistanceToBeam = 0.0200 // 200 microns
		double minVertexFitProb = 0.01 // 1% vertex fit probability
	}
	PSet VtxFinderParameters = 
	{
		double minTrackCompatibilityToMainVertex = 0.05 // 5%
		double minTrackCompatibilityToOtherVertex = 0.01 // 1%
		int32 maxNbVertices = 0 // search all vertices in each cluster
	}
  }

  module out = PoolOutputModule 
  { 
	untracked string fileName = "pv.root"
  }

  path p = 
  {
    primaryVertexProducer
#    trackAnalyzer
  }
  
  endpath e = 
  {
    out
  }
}
